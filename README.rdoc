Wikipedia double implementation based on @mackenziechild's tutorial.
